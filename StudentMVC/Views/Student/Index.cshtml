@model IEnumerable<DataAccessLayer.StudentDetail>

<h1 style="color:black">Student List</h1>
<button id="addStudentBtn" class="btn btn-success">Add New Student</button>

<div id="studentListContainer">
    @await Html.PartialAsync("_StudentListPartial", Model)
</div>

<div id="createEditStudentModal" class="modal fade" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Student Detail</h5>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body" id="createEditStudentContainer"></div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
$(document).ready(function () {

    // Open create form
    $('#addStudentBtn').click(function () {
        $('#createEditStudentContainer').load('@Url.Action("CreateEditStudent", "Student")', function () {
            $('#createEditStudentModal').modal('show');
        });
    });

    // Open edit form (note selector name .edit-student)
    $('#studentListContainer').on('click', '.edit-student', function () {
        var studentId = $(this).data('id');
        $('#createEditStudentContainer').load('@Url.Action("CreateEditStudent", "Student")/' + studentId, function () {
            $('#createEditStudentModal').modal('show');
        });
    });
     // Open details form (note selector name .details-student)
    $('#studentListContainer').on('click', '.details-student', function () {
        var studentId = $(this).data('id');
        $('#createEditStudentContainer').load('@Url.Action("Detailsstudent", "Student")/' + studentId, function () {
            $('#createEditStudentModal').modal('show');
        });
    });

    // Save via AJAX
    $('#createEditStudentContainer').on('submit', '#studentForm', function (e) {
        e.preventDefault();
        var formData = $(this).serialize();
        $.post('@Url.Action("SaveStudent", "Student")', formData, function (response) {
            if (response.success) {
                $('#createEditStudentModal').modal('hide');
                $('#studentListContainer').load('@Url.Action("StudentList", "Student")');
            } else {
                alert('Error saving Student: ' + (response.message || 'Unknown'));
            }
        });
    });

    // Delete via AJAX
    $('#studentListContainer').on('click', '.delete-student', function () {
        if (!confirm('Are you sure you want to delete this student?')) return;
        var studentId = $(this).data('id');
        $.post('@Url.Action("DeleteStudents", "Student")', { id: studentId }, function (response) {
        if (response.success) {
        $('#studentListContainer').load('@Url.Action("StudentList", "Student")');

            } else {
                alert('Error deleting Student.');
            }
        });
    });

});
    </script>
}